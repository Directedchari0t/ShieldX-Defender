rule Exploit_Detection {
    meta:
        author = "KoalaShield Team"
        description = "Detects common exploit patterns"
    strings:
        $shellcode = {6A 40 68 00 30 00 00 6A 14 8D 91}
        $powershell_exploit = "Invoke-Mimikatz" nocase
    condition:
        any of them
}
rule PowerShell_Exploit {
    meta:
        description = "Detects suspicious PowerShell patterns"
    strings:
        $ps1 = "powershell.exe" nocase
        $bypass = /-ExecutionPolicy\s+Bypass/
    condition:
        all of them
}
rule Suspicious_ZIP {
    meta:
        description = "Detects suspicious ZIP files"
    strings:
        $zip_magic = { 50 4B 03 04 }  // ZIP file magic number
    condition:
        $zip_magic at 0
}
